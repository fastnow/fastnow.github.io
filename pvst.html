<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pixiv éšæœºST | è¯·èŠ‚åˆ¶ä½¿ç”¨ğŸ¤ğŸ¤</title>
    <meta name="description" content="ç²¾é€‰Pç«™é«˜è´¨é‡äºŒæ¬¡å…ƒåŠ¨æ¼«å›¾ç‰‡åº“ï¼Œæ¯æ—¥æ›´æ–°åŠ¨æ¼«ã€æ¸¸æˆè§’è‰²å›¾ç‰‡ï¼ŒåŒ…æ‹¬åŸç¥ã€å´©åã€åˆéŸ³æœªæ¥ç­‰çƒ­é—¨ä½œå“è§’è‰²ã€‚åŒ…å«äººæ°”åŠ¨æ¼«è§’è‰²æ’ç”»ç­‰ã€‚">
    <meta name="keywords" content="ç‘Ÿ, éšæœºå›¾ç‰‡, pixiv, pç«™, äºŒæ¬¡å…ƒ,åŠ¨æ¼«å›¾ç‰‡,åŠ¨æ¼«è§’è‰²,æ’ç”»,åŠ¨æ¼«è‰ºæœ¯,é«˜æ¸…åŠ¨æ¼«å›¾,åŠ¨æ¼«ä¸‹è½½">
    <meta name="author" content="FastNow Studio">

<style>
body {
    margin: 0;
    padding: 10px;
    background: #fff;
    color: #000;
    font: 14px monospace;
    transition: background-color 0.3s, color 0.3s;
}

body.dark-mode {
    background: #000;
    color: #fff;
}

.container {
    max-width: 1000px;
    margin: 0 auto;
}

.loading {
    text-align: center;
    padding: 20px;
}

.grid {
    display: block;
}

.preview-box {
    cursor: pointer;
    border: 1px solid #ccc;
    margin-bottom: 10px;
    transition: border-color 0.3s;
}

.dark-mode .preview-box {
    border-color: #444;
}

.preview-img {
    width: 100%;
    height: auto;
    display: block;
}

.meta-item {
    margin: 10px 0;
    padding: 10px;
    border-left: 3px solid #06c;
    transition: border-color 0.3s, background-color 0.3s;
}

.dark-mode .meta-item {
    border-left-color: #0af;
    background-color: #111;
}

.tag {
    display: inline-block;
    background: #ddd;
    padding: 2px 8px;
    margin: 2px;
    border-radius: 3px;
    transition: background-color 0.3s, color 0.3s;
}

.dark-mode .tag {
    background: #333;
    color: #eee;
}

.button {
    background: #06c;
    color: #fff;
    border: none;
    padding: 8px 12px;
    margin: 5px;
    cursor: pointer;
    border-radius: 4px;
    transition: background-color 0.3s, opacity 0.3s;
    text-decoration: none;
    display: inline-block;
}

.dark-mode .button {
    background: #0af;
}

.button:hover {
    opacity: 0.9;
}

.theme-toggle {
    position: fixed;
    bottom: 20px;
    right: 20px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    font-size: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    z-index: 98;
}

.disclaimer {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: #000;
    color: #fff;
    z-index: 100;
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.disclaimer-content {
    max-width: 600px;
    background: #111;
    padding: 30px;
    border-radius: 10px;
    text-align: center;
}

.zoom-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.95);
    z-index: 99;
    display: flex;
    align-items: center;
    justify-content: center;
}

.zoom-img {
    max-width: 90%;
    max-height: 90%;
    object-fit: contain;
}
</style>
</head>
<body>
<div id="disclaimer" class="disclaimer">
    <div class="disclaimer-content">
        <h2>æ³¨æ„</h2>
        <p>1. å†…å®¹ä¸ºè‡ªåŠ¨æ”¶é›†ï¼Œä¸ä»£è¡¨æœ¬ç«™ç«‹åœº</p>
        <p>2. ä½¿ç”¨è€…è‡ªè¡Œåˆ¤æ–­ï¼Œæœ¬ç«™ä¸æ‰¿æ‹…æ³•å¾‹è´£ä»»</p>
        <p>3. å›¾ç‰‡æ— æ³•æ˜¾ç¤ºè¯·åˆ·æ–°</p>
        <p>4. ç»§ç»­ä½¿ç”¨è¡¨ç¤ºåŒæ„æœ¬å£°æ˜</p>
        <p>&copy; <script>document.write(new Date().getFullYear())</script> FastNow Studio</p>
        <button class="button" onclick="acceptDisclaimer()">åŒæ„å¹¶ç»§ç»­</button>
    </div>
</div>
<div class="container">
    <div id="loading" class="loading">åŠ è½½ä¸­...</div>
    <div id="display-area"></div>
</div>
<button class="button theme-toggle" onclick="toggleTheme()">ğŸŒ“</button>
<script>
const endpoints = {
    list: 'https://fastly.jsdelivr.net/gh/Mabbs/pixiv-index/index.json',
    detail: 'https://fastly.jsdelivr.net/gh/Mabbs/pixiv-index/data/',
    image: 'i.adba.dpdns.org/'
};

let currentData = null;
let isDarkMode = false;

function initTheme() {
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-mode');
        isDarkMode = true;
        updateThemeButton();
    }
}

function updateThemeButton() {
    const button = document.querySelector('.theme-toggle');
    button.textContent = isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
}

function toggleTheme() {
    isDarkMode = !isDarkMode;
    document.body.classList.toggle('dark-mode', isDarkMode);
    localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
    updateThemeButton();
}

function loadContent() {
    document.getElementById('loading').style.display = 'block';
    
    fetch(endpoints.list)
        .then(r => r.json())
        .then(files => {
            if (!files || files.length === 0) {
                throw new Error('æ²¡æœ‰å¯ç”¨çš„æ•°æ®');
            }
            
            const f = files[Math.floor(Math.random() * files.length)];
            return fetch(endpoints.detail + (f.includes('.json') ? f : f + '.json'));
        })
        .then(r => r.json())
        .then(data => {
            currentData = data;
            const c = document.getElementById('display-area');
            const img = data.urls?.regular || data.url;
            const t = new Date(data.uploadDate);
            
            const originalUrl = data.urls?.original || data.url;
            
            c.innerHTML = `
                <div class="preview-box" onclick="zoomImage()">
                    <img class="preview-img" src="${img}" alt="${data.title || 'é¢„è§ˆå›¾'}" loading="lazy">
                </div>
                <div class="meta-item">
                    <strong>${data.title || 'æ— æ ‡é¢˜'}</strong><br>
                    ä½œè€…ï¼š${data.author || 'æœªçŸ¥'}<br>
                    PIDï¼š${data.pid || 'æœªçŸ¥'}<br>
                    æ—¶é—´ï¼š${t.toLocaleString('zh-CN')}<br>
                    å°ºå¯¸ï¼š${data.width || 0}Ã—${data.height || 0}<br>
                    AIï¼š${data.aiType ? 'æ˜¯' : 'å¦'}
                </div>
                <div class="meta-item">
                    æ ‡ç­¾ï¼š${data.tags ? data.tags.map(t => `<span class="tag">${t}</span>`).join('') : 'æ— æ ‡ç­¾'}
                </div>
                <div>
                    <a class="button" href="${originalUrl}" target="_blank" onclick="handleDownloadClick(event)">ä¸‹è½½</a>
                    <button class="button" onclick="loadContent()">éšæœº</button>
                </div>
            `;
            
            document.getElementById('loading').style.display = 'none';
        })
        .catch(e => {
            console.error('åŠ è½½å¤±è´¥:', e);
            alert('åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•');
            document.getElementById('loading').style.display = 'none';
        });
}

function handleDownloadClick(event) {
    console.log('ä¸‹è½½å›¾ç‰‡:', currentData?.pid);
    event.preventDefault();
}

function checkDisclaimer() {
    if (!localStorage.disclaimerAccepted) {
        document.getElementById('disclaimer').style.display = 'flex';
    }
}

function acceptDisclaimer() {
    localStorage.disclaimerAccepted = 1;
    document.getElementById('disclaimer').style.display = 'none';
    loadContent();
}

function zoomImage() {
    if (!currentData) return;
    
    const overlay = document.createElement('div');
    overlay.className = 'zoom-overlay';
    overlay.onclick = (e) => {
        if (e.target === overlay) {
            document.body.removeChild(overlay);
        }
    };
    
    const img = document.createElement('img');
    img.className = 'zoom-img';
    img.src = currentData.urls?.original || currentData.url;
    img.alt = currentData.title || 'æ”¾å¤§å›¾';
    
    overlay.appendChild(img);
    document.body.appendChild(overlay);
    
    const keyHandler = (e) => {
        if (e.key === 'Escape') {
            document.body.removeChild(overlay);
            document.removeEventListener('keydown', keyHandler);
        }
    };
    document.addEventListener('keydown', keyHandler);
}

document.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight') {
        loadContent();
    }
    if (e.key === 't' && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();
        toggleTheme();
    }
    if (e.key === 'd' && (e.ctrlKey || e.metaKey)) {
        e.preventDefault();
        const downloadBtn = document.querySelector('a[href*="i.pximg.net"]');
        if (downloadBtn) {
            downloadBtn.click();
        }
    }
});

window.onload = () => {
    initTheme();
    checkDisclaimer();
    if (localStorage.disclaimerAccepted) {
        loadContent();
    }
};
</script>
</body>
</html>