<!DOCTYPE html>
<html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><meta name="description" content="音乐聚合解析平台-支持网易云音乐、咪咕音乐、千千音乐、汽水音乐、喜马拉雅音乐等多平台音乐搜索与播放"><meta name="keywords" content="音乐解析,在线音乐,网易云音乐,咪咕音乐,千千音乐,汽水音乐,喜马拉雅音乐"><title>音乐聚合解析平台-多平台音乐搜索与播放</title><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><style>*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',-apple-system,BlinkMacSystemFont,sans-serif;}body{background:#f8f9fa;color:#333;line-height:1.6;padding:20px;min-height:100vh;padding-bottom:80px;}.container{max-width:900px;margin:0 auto;background-color:white;border-radius:8px;box-shadow:0 2px 10px rgba(0,0,0,0.05);padding:25px;}h1{text-align:center;margin-bottom:25px;color:#2c3e50;font-weight:600;font-size:24px;}.search-section{margin-bottom:25px;padding:20px;background:#f8f9fa;border-radius:8px;}.search-box{display:flex;margin-bottom:15px;}.search-box input{flex:1;padding:12px 15px;border:1px solid #e0e0e0;border-radius:6px 0 0 6px;font-size:16px;transition:all 0.2s;background:white;}.search-box input:focus{outline:none;border-color:#3498db;}.search-box button{padding:12px 20px;background:#3498db;color:white;border:none;border-radius:0 6px 6px 0;cursor:pointer;font-size:16px;font-weight:500;transition:all 0.2s;}.search-box button:hover{background:#2980b9;}.search-options{display:flex;flex-wrap:wrap;gap:15px;margin-bottom:15px;align-items:center;}.option-group{display:flex;align-items:center;gap:8px;}.option-group label{font-weight:500;color:#555;font-size:14px;}select{padding:8px 12px;border:1px solid #e0e0e0;border-radius:6px;background:white;transition:all 0.2s;}select:focus{outline:none;border-color:#3498db;}.platform-selector{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px;}.platform-tab{padding:8px 15px;cursor:pointer;text-align:center;background:#f1f1f1;border-radius:20px;font-size:13px;transition:all 0.2s;border:1px solid transparent;}.platform-tab:hover{background:#e9e9e9;}.platform-tab.active{color:white;background:#3498db;}.song-list{margin-top:20px;max-height:400px;overflow-y:auto;border:1px solid #eee;border-radius:8px;}.song-item{padding:15px;border-bottom:1px solid #eee;cursor:pointer;display:flex;justify-content:space-between;align-items:center;transition:all 0.2s;}.song-item:hover{background-color:#f9f9f9;}.song-item:last-child{border-bottom:none;}.song-info{display:flex;flex-direction:column;flex:1;}.song-title{font-weight:600;margin-bottom:5px;}.song-singer{color:#666;font-size:14px;}.song-platform{color:white;font-size:11px;padding:3px 8px;border-radius:10px;}.song-detail{margin-top:20px;padding:20px;background:#f8f9fa;border-radius:8px;display:none;}.song-detail.active{display:block;}.detail-header{display:flex;align-items:center;margin-bottom:20px;}.cover-img{width:100px;height:100px;border-radius:6px;margin-right:20px;object-fit:cover;}.detail-info{flex:1;}.detail-title{font-size:20px;font-weight:600;margin-bottom:8px;color:#2c3e50;}.detail-singer{color:#666;margin-bottom:10px;font-size:15px;}.audio-player{width:100%;margin:20px 0;border-radius:6px;}.lyrics-container{margin-top:20px;max-height:300px;overflow-y:auto;padding:15px;background-color:#fff;border-radius:6px;border:1px solid #eee;}.lyrics-content{font-size:14px;line-height:1.8;text-align:center;min-height:150px;display:flex;overflow-y:auto;scroll-behavior:smooth;flex-direction:column;justify-content:center;}.lyric-line{padding:6px 0;transition:all 0.2s;opacity:0.6;min-height:22px;}.lyric-line.active{font-size:16px;font-weight:600;color:#3498db;opacity:1;}.loading{text-align:center;padding:25px;display:none;}.loading:after{content:'';display:inline-block;width:20px;height:20px;border:3px solid rgba(52,152,219,0.3);border-radius:50%;border-top-color:#3498db;animation:spin 1s ease-in-out infinite;margin-left:10px;vertical-align:middle;}@keyframes spin{to{transform:rotate(360deg);}}.error{color:#e74c3c;text-align:center;padding:12px;display:none;background:#ffeaea;border-radius:6px;margin:10px 0;}.back-btn{margin-top:15px;padding:10px 20px;background:#95a5a6;color:white;border:none;border-radius:6px;cursor:pointer;font-weight:500;transition:all 0.2s;}.back-btn:hover{background:#7f8c8d;}.empty-state{text-align:center;padding:40px 20px;color:#666;}footer{margin-top:25px;text-align:center;font-size:13px;color:#666;border-top:1px solid #eee;padding-top:15px;}.bottom-player{position:fixed;bottom:0;left:0;right:0;background:white;box-shadow:0 -2px 10px rgba(0,0,0,0.05);padding:10px 15px;display:flex;align-items:center;z-index:1000;border-top:1px solid #eee;height:70px;gap:15px;}.player-info{display:flex;align-items:center;flex:0 0 auto;min-width:0;max-width:200px;cursor:pointer;transition:all 0.2s;}.player-info:hover{opacity:0.8;}.player-cover{width:40px;height:40px;border-radius:5px;margin-right:10px;object-fit:cover;flex-shrink:0;}.player-text{display:flex;flex-direction:column;min-width:0;flex:1;}.player-title{font-weight:600;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.player-singer{font-size:12px;color:#666;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}.player-progress{display:flex;align-items:center;flex:1;min-width:0;margin:0 20px;gap:10px;}.progress-time{font-size:12px;color:#666;min-width:40px;flex-shrink:0;}.progress-bar{flex:1;height:4px;background:#eee;border-radius:2px;position:relative;cursor:pointer;min-width:100px;}.progress-fill{position:absolute;left:0;top:0;height:100%;background:#3498db;border-radius:2px;width:0%;transition:width 0.1s linear;}.player-controls{display:flex;align-items:center;gap:15px;flex:0 0 auto;margin-left:auto;}.player-btn{background:none;border:none;color:#555;cursor:pointer;font-size:16px;transition:all 0.2s;flex-shrink:0;}.player-btn:hover{color:#3498db;}.player-btn.play-pause{background:#3498db;color:white;width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;}.player-btn.play-pause:hover{background:#2980b9;}.play-mode-btn{background:none;border:none;color:#555;cursor:pointer;font-size:16px;transition:all 0.2s;flex-shrink:0;}.play-mode-btn:hover{color:#3498db;}@media (max-width:768px){.container{padding:15px;}.search-section{padding:15px;}.bottom-player{padding:8px 10px;height:60px;gap:10px;}.player-info{max-width:150px;}.player-cover{width:35px;height:35px;}.player-controls{gap:10px;}.player-btn{font-size:14px;}.player-btn.play-pause{width:32px;height:32px;}.progress-time{min-width:35px;font-size:11px;}.player-progress{margin:0 10px;}}@media (max-width:600px){body{padding:10px;padding-bottom:70px;}.container{padding:10px;}h1{font-size:20px;margin-bottom:20px;}.search-section{padding:10px;}.search-box{flex-direction:column;}.search-box input{border-radius:6px;margin-bottom:10px;}.search-box button{border-radius:6px;}.platform-selector{justify-content:center;}.detail-header{flex-direction:column;text-align:center;}.cover-img{margin-right:0;margin-bottom:15px;}.bottom-player{flex-wrap:nowrap;padding:5px 8px;height:55px;gap:8px;}.player-info{max-width:120px;}.player-cover{width:30px;height:30px;margin-right:8px;}.player-title{font-size:12px;}.player-singer{font-size:10px;}.player-controls{gap:8px;}.player-btn{font-size:12px;}.player-btn.play-pause{width:28px;height:28px;}.progress-time{min-width:30px;font-size:10px;}.progress-bar{min-width:80px;}.player-progress{margin:0 5px;}}</style></head><body><div class="container"><h1>音乐聚合解析平台 v0.3.0</h1><div class="search-section"><div class="search-options"><div class="option-group"><label for="search-type">搜索类型:</label><select id="search-type"><option value="keyword">关键词搜索</option><option value="netease-id">网易云歌曲ID</option><option value="playlist">网易云歌单ID</option><option value="track-id">汽水音乐ID</option><option value="mg-id">咪咕音乐ID</option></select></div></div><div class="search-box"><input type="text" id="search-input" placeholder="输入歌曲名、歌手名或音乐ID"><button id="search-btn">搜索</button></div><div class="platform-selector"><div class="platform-tab active" data-platform="all">全部平台</div><div class="platform-tab netease-tab" data-platform="netease">网易云音乐</div><div class="platform-tab mg-tab" data-platform="mg">咪咕音乐</div><div class="platform-tab qianqian-tab" data-platform="qianqian">千千音乐</div><div class="platform-tab qishui-tab" data-platform="qishui">汽水音乐</div><div class="platform-tab ximalaya-tab" data-platform="ximalaya">喜马拉雅</div></div></div><div class="loading" id="loading">Loading...</div><div class="error" id="error"></div><div class="song-list" id="song-list"><div class="empty-state"><p><strong>输入歌曲名、歌手名或音乐ID开始搜索</strong><br>音乐版权归各平台所有 <strong>请勿滥用该项目</strong><br>如遇异常情况 可在Github Issues中反馈</p></div></div><div class="song-detail" id="song-detail"><div class="detail-header"><img src="" alt="歌曲封面" class="cover-img" id="cover-img"><div class="detail-info"><div class="detail-title" id="detail-title"></div><div class="detail-singer" id="detail-singer"></div><div id="platform-info"></div></div></div><audio controls class="audio-player" id="audio-player"></audio><div class="lyrics-container"><div class="lyrics-title"></div><div class="lyrics-content" id="lyrics-content"></div></div><button class="back-btn" id="back-btn">返回列表</button></div></div><div class="bottom-player" id="bottom-player" style="display:none;"><div class="player-info" id="player-info"><img src="" alt="封面" class="player-cover" id="player-cover"><div class="player-text"><div class="player-title" id="player-title">歌曲名称</div><div class="player-singer" id="player-singer">歌手</div></div></div><div class="player-progress"><span class="progress-time" id="current-time">0:00</span><div class="progress-bar" id="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><span class="progress-time" id="duration-time">0:00</span></div><div class="player-controls"><button class="player-btn" id="prev-btn"><i class="fas fa-step-backward"></i></button><button class="player-btn play-pause" id="play-pause-btn"><i class="fas fa-play" id="play-icon"></i></button><button class="player-btn" id="next-btn"><i class="fas fa-step-forward"></i></button><button class="play-mode-btn" id="play-mode-btn" title="列表循环"><i class="fas fa-repeat"></i></button></div></div><footer><p>&copy;<script>document.write(new Date().getFullYear())</script> <strong>FastNow Studio</strong> | BSD 3-Clause | 音乐聚合解析平台-支持网易云音乐、咪咕音乐、千千音乐、汽水音乐、喜马拉雅音乐等多平台音乐搜索与播放</p></footer><script>document.addEventListener('DOMContentLoaded',function(){const searchInput=document.getElementById('search-input'),searchBtn=document.getElementById('search-btn'),searchType=document.getElementById('search-type'),platformTabs=document.querySelectorAll('.platform-tab'),songList=document.getElementById('song-list'),songDetail=document.getElementById('song-detail'),detailTitle=document.getElementById('detail-title'),detailSinger=document.getElementById('detail-singer'),coverImg=document.getElementById('cover-img'),platformInfo=document.getElementById('platform-info'),audioPlayer=document.getElementById('audio-player'),lyricsContent=document.getElementById('lyrics-content'),backBtn=document.getElementById('back-btn'),loading=document.getElementById('loading'),error=document.getElementById('error'),bottomPlayer=document.getElementById('bottom-player'),playerInfo=document.getElementById('player-info'),playerCover=document.getElementById('player-cover'),playerTitle=document.getElementById('player-title'),playerSinger=document.getElementById('player-singer'),playPauseBtn=document.getElementById('play-pause-btn'),playIcon=document.getElementById('play-icon'),prevBtn=document.getElementById('prev-btn'),nextBtn=document.getElementById('next-btn'),currentTimeEl=document.getElementById('current-time'),durationTimeEl=document.getElementById('duration-time'),progressBar=document.getElementById('progress-bar'),progressFill=document.getElementById('progress-fill'),playModeBtn=document.getElementById('play-mode-btn');let currentPlatform='all',searchResults=[],lyricLines=[],currentLyricIndex=-1,currentSongIndex=-1,playMode='list',currentSongData=null,isAutoPlayNext=false;platformTabs.forEach(tab=>{tab.addEventListener('click',function(){platformTabs.forEach(t=>t.classList.remove('active'));this.classList.add('active');currentPlatform=this.getAttribute('data-platform');displaySongList(searchResults);});});searchBtn.addEventListener('click',searchSongs);searchInput.addEventListener('keypress',function(e){if(e.key==='Enter'){searchSongs();}});backBtn.addEventListener('click',function(){songDetail.classList.remove('active');songList.style.display='block';lyricLines=[];currentLyricIndex=-1;});playerInfo.addEventListener('click',function(){if(currentSongData){showSongDetail(currentSongData);}});playPauseBtn.addEventListener('click',togglePlayPause);prevBtn.addEventListener('click',playPrevSong);nextBtn.addEventListener('click',playNextSong);playModeBtn.addEventListener('click',togglePlayMode);progressBar.addEventListener('click',function(e){const rect=progressBar.getBoundingClientRect();const percent=(e.clientX-rect.left)/rect.width;audioPlayer.currentTime=percent*audioPlayer.duration;});audioPlayer.addEventListener('timeupdate',updateProgress);audioPlayer.addEventListener('timeupdate',updateLyrics);audioPlayer.addEventListener('seeked',updateLyrics);audioPlayer.addEventListener('loadedmetadata',function(){durationTimeEl.textContent=formatTime(audioPlayer.duration);});audioPlayer.addEventListener('ended',function(){handleSongEnd();});audioPlayer.addEventListener('play',function(){playIcon.className='fas fa-pause';});audioPlayer.addEventListener('pause',function(){playIcon.className='fas fa-play';});function searchSongs(){const query=searchInput.value.trim();if(!query){showError('请输入搜索内容');return;}loading.style.display='block';error.style.display='none';songList.innerHTML='';songDetail.classList.remove('active');songList.style.display='block';const searchTypeValue=searchType.value;const promises=[];if((currentPlatform==='all'||currentPlatform==='netease')&&(searchTypeValue==='keyword'||searchTypeValue==='netease-id'||searchTypeValue==='playlist')){if(searchTypeValue==='netease-id'){promises.push(fetch(`https://api.paugram.com/netease/?id=${query}`).then(response=>response.json()).then(data=>{if(data&&data.title){return{platform:'netease',data:[data]};}else{return{platform:'netease',error:'未找到相关歌曲'};}}).catch(err=>{return{platform:'netease',error:err.message};}));}else if(searchTypeValue==='playlist'){promises.push(fetch(`https://api.injahow.cn/meting/?type=playlist&id=${query}&server=netease`).then(response=>response.json()).then(data=>{if(data&&Array.isArray(data)){const playlistSongs=data.map(song=>({platform:'netease',title:song.name,singer:song.artist,cover:song.pic,link:song.url,lrc:song.lrc,isPlaylistItem:true}));return{platform:'netease',data:playlistSongs};}else{return{platform:'netease',error:'未找到相关歌单'};}}).catch(err=>{return{platform:'netease',error:err.message};}));}else{promises.push(fetch(`https://163api.qijieya.cn/search?keywords=${encodeURIComponent(query)}`).then(response=>response.json()).then(data=>{if(data&&data.result&&data.result.songs&&data.result.songs.length>0){const searchSongs=data.result.songs.map(song=>({platform:'netease',title:song.name,singer:song.artists.map(artist=>artist.name).join('/'),id:song.id,cover:song.album&&song.album.picId?`https://p1.music.126.net/${song.album.picId}/${song.album.picId}.jpg`:'',album:song.album?song.album.name:'',duration:song.duration,isSearchResult:true}));return{platform:'netease',data:searchSongs};}else{return{platform:'netease',error:'未找到相关歌曲'};}}).catch(err=>{return{platform:'netease',error:err.message};}));}}if((currentPlatform==='all'||currentPlatform==='mg')&&searchTypeValue==='mg-id'){promises.push(fetch(`https://api-v2.cenguigui.cn/api/mg_music/api.php?id=${query}`).then(response=>response.json()).then(data=>{if(data&&data.code===200){const mgSong={platform:'mg',title:data.name,singer:data.artist,album:data.album,cover:data.pic,id:data.id,lyric:data.lyric,link:data.data&&data.data.length>0?data.data[data.data.length-1].url:data.url};return{platform:'mg',data:[mgSong]};}else{return{platform:'mg',error:'未找到相关歌曲'};}}).catch(err=>{return{platform:'mg',error:err.message};}));}if((currentPlatform==='all'||currentPlatform==='qianqian')&&searchTypeValue==='keyword'){promises.push(fetch(`https://api-v2.cenguigui.cn/api/music/qianqian_music.php?msg=${encodeURIComponent(query)}&type=json`).then(response=>response.json()).then(data=>{if(data&&data.code===200){if(data.data&&data.data.title){const qianqianSong={platform:'qianqian',title:data.data.title,singer:data.data.singer,cover:data.data.cover,link:data.data.music_url,lyric:data.data.lyric,isSingleResult:true};return{platform:'qianqian',data:[qianqianSong]};}else if(Array.isArray(data.data)){const songs=data.data.map((song,index)=>({platform:'qianqian',title:song.title||`歌曲${index+1}`,singer:song.singer||'未知歌手',cover:song.cover||'',number:index+1,query:query,needsDetailLookup:true}));return{platform:'qianqian',data:songs};}else{return{platform:'qianqian',error:'未找到相关歌曲'};}}else{return{platform:'qianqian',error:'未找到相关歌曲'};}}).catch(err=>{return{platform:'qianqian',error:err.message};}));}if((currentPlatform==='all'||currentPlatform==='qishui')&&(searchTypeValue==='keyword'||searchTypeValue==='track-id')){let qishuiUrl='https://api-v2.cenguigui.cn/api/qishui/?';if(searchTypeValue==='track-id'){qishuiUrl+=`track_id=${query}`;}else{qishuiUrl+=`msg=${encodeURIComponent(query)}`;}qishuiUrl+='&type=json';promises.push(fetch(qishuiUrl).then(response=>response.json()).then(data=>{if(data.code===200&&data.data){if(data.data.title){const qishuiSong={platform:'qishui',title:data.data.title,singer:data.data.singer,cover:data.data.cover,link:data.data.music,lyric:data.data.lrc,isSingleResult:true};return{platform:'qishui',data:[qishuiSong]};}else if(Array.isArray(data.data)){const songs=data.data.map((song,index)=>({platform:'qishui',title:song.title,singer:song.singer,number:song.n||index+1,query:query,needsDetailLookup:true}));return{platform:'qishui',data:songs};}else{return{platform:'qishui',error:'未找到相关歌曲'};}}else{return{platform:'qishui',error:'未找到相关歌曲'};}}).catch(err=>{return{platform:'qishui',error:err.message};}));}if((currentPlatform==='all'||currentPlatform==='ximalaya')&&searchTypeValue==='keyword'){promises.push(fetch(`https://api-v2.cenguigui.cn/api/music/dg_ximalayamusic.php?msg=${encodeURIComponent(query)}&type=json`).then(response=>response.json()).then(data=>{if(data&&data.data&&Array.isArray(data.data)&&data.data.length>0){const songs=data.data.map(item=>{let title=item.title,singer=item.Nickname||'未知主播';const titleParts=title.split(' - ');if(titleParts.length>1){singer=titleParts[0].trim();title=titleParts[1].trim();}return{platform:'ximalaya',title:title,singer:singer,cover:item.cover,n:item.n,trackId:item.trackId,album_id:item.album_id,query:query,needsDetailLookup:true};});return{platform:'ximalaya',data:songs};}else{return{platform:'ximalaya',error:'未找到相关歌曲'};}}).catch(err=>{return{platform:'ximalaya',error:err.message};}));}Promise.all(promises).then(results=>{loading.style.display='none';searchResults=[];let hasResults=false;results.forEach(result=>{if(result.data){hasResults=true;if(result.platform==='netease'){result.data.forEach(song=>{searchResults.push({platform:'netease',title:song.title,singer:song.singer,cover:song.cover,link:song.link,lrc:song.lrc,id:song.id,album:song.album,duration:song.duration,isPlaylistItem:song.isPlaylistItem||false,isSearchResult:song.isSearchResult||false});});}else if(result.platform==='mg'){result.data.forEach(song=>{searchResults.push({platform:'mg',title:song.title,singer:song.singer,cover:song.cover,link:song.link,id:song.id,album:song.album,lyric:song.lyric});});}else if(result.platform==='qianqian'){result.data.forEach(song=>{searchResults.push({platform:'qianqian',title:song.title,singer:song.singer,cover:song.cover,link:song.link,lyric:song.lyric,number:song.number,query:song.query,isSingleResult:song.isSingleResult||false,needsDetailLookup:song.needsDetailLookup||false});});}else if(result.platform==='qishui'){result.data.forEach(song=>{searchResults.push({platform:'qishui',title:song.title,singer:song.singer,cover:song.cover,link:song.link,lyric:song.lyric,number:song.number,query:song.query,isSingleResult:song.isSingleResult||false,needsDetailLookup:song.needsDetailLookup||false});});}else if(result.platform==='ximalaya'){result.data.forEach(song=>{searchResults.push({platform:'ximalaya',title:song.title,singer:song.singer,cover:song.cover,n:song.n,trackId:song.trackId,album_id:song.album_id,query:song.query,needsDetailLookup:song.needsDetailLookup||false});});}}});if(hasResults){displaySongList(searchResults);}else{showError('未找到相关歌曲');songList.innerHTML='<div class="empty-state"><p>未找到相关歌曲</p></div>';}}).catch(err=>{loading.style.display='none';showError('搜索失败，请稍后重试');console.error(err);});}function displaySongList(songs){songList.innerHTML='';if(songs.length===0){songList.innerHTML='<div class="empty-state"><p>未找到相关歌曲</p></div>';return;}const filteredSongs=currentPlatform==='all'?songs:songs.filter(song=>song.platform===currentPlatform);if(filteredSongs.length===0){songList.innerHTML='<div class="empty-state"><p>该平台未找到相关歌曲</p></div>';return;}filteredSongs.forEach((song,index)=>{const songItem=document.createElement('div');songItem.className='song-item';let platformBadge='',badgeColor='#3498db';switch(song.platform){case'netease':platformBadge='网易云';badgeColor='#d43c33';break;case'mg':platformBadge='咪咕';badgeColor='#ea4335';break;case'qianqian':platformBadge='千千';badgeColor='#f57c00';break;case'qishui':platformBadge='汽水';badgeColor='#00bcd4';break;case'ximalaya':platformBadge='喜马拉雅';badgeColor='#ff6f00';break;}songItem.innerHTML=`<div class="song-info"><div class="song-title">${song.title}</div><div class="song-singer">${song.singer}</div></div><span class="song-platform" style="background:${badgeColor}">${platformBadge}</span>`;songItem.addEventListener('click',function(){currentSongIndex=index;getSongDetail(song);});songList.appendChild(songItem);});}function getSongDetail(song){loading.style.display='block';error.style.display='none';if(song.platform==='netease'){if(song.isSearchResult){fetch(`https://api.paugram.com/netease/?id=${song.id}`).then(response=>response.json()).then(songData=>{loading.style.display='none';if(songData&&songData.title){const fullSongData={...song,title:songData.name||songData.title,singer:songData.artist,album:songData.album||'',cover:songData.pic||songData.cover,link:songData.link,lyric:songData.lyric,sub_lyric:songData.sub_lyric,isSearchResult:false};if(!isAutoPlayNext){showSongDetail(fullSongData);}updateBottomPlayer(fullSongData);audioPlayer.src=fullSongData.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));}else{showError('解析歌曲失败');}}).catch(err=>{loading.style.display='none';showError('解析歌曲失败');});}else if(song.link){loading.style.display='none';if(!isAutoPlayNext){showSongDetail(song);}updateBottomPlayer(song);audioPlayer.src=song.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));if(song.lrc){fetch(song.lrc).then(response=>response.text()).then(text=>{parseLyrics(text);}).catch(err=>{if(!isAutoPlayNext){lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">无法加载歌词</div>';}});}}else{loading.style.display='none';showError('无法获取音频文件');}}else if(song.platform==='mg'){if(song.id){fetch(`https://api-v2.cenguigui.cn/api/mg_music/api.php?id=${song.id}`).then(response=>response.json()).then(data=>{loading.style.display='none';if(data&&data.code===200){const fullSongData={platform:'mg',title:data.name,singer:data.artist,album:data.album,cover:data.pic,lyric:data.lyric,link:data.data&&data.data.length>0?data.data[data.data.length-1].url:data.url};if(!isAutoPlayNext){showSongDetail(fullSongData);}updateBottomPlayer(fullSongData);audioPlayer.src=fullSongData.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));if(data.lyric){parseLyrics(data.lyric);}}else{showError('获取咪咕音乐失败');}}).catch(err=>{loading.style.display='none';showError('获取咪咕音乐失败');});}else{loading.style.display='none';showError('无法获取咪咕音乐');}}else if(song.platform==='qianqian'){if(song.needsDetailLookup&&song.number){fetch(`https://api-v2.cenguigui.cn/api/music/qianqian_music.php?msg=${encodeURIComponent(song.query)}&n=${song.number}&type=json`).then(response=>response.json()).then(data=>{loading.style.display='none';if(data&&data.code===200&&data.data){const fullSongData={platform:'qianqian',title:data.data.title,singer:data.data.singer,cover:data.data.cover,link:data.data.music_url,lyric:data.data.lyric};if(!isAutoPlayNext){showSongDetail(fullSongData);}updateBottomPlayer(fullSongData);audioPlayer.src=fullSongData.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));if(data.data.lyric&&data.data.lyric.startsWith('http')){fetch(data.data.lyric).then(response=>response.text()).then(text=>{parseLyrics(text);}).catch(err=>{if(!isAutoPlayNext){lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">无法加载歌词</div>';}});}}else{showError('获取千千音乐失败');}}).catch(err=>{loading.style.display='none';showError('获取千千音乐失败');});}else if(song.link){loading.style.display='none';if(!isAutoPlayNext){showSongDetail(song);}updateBottomPlayer(song);audioPlayer.src=song.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));if(song.lyric&&song.lyric.startsWith('http')){fetch(song.lyric).then(response=>response.text()).then(text=>{parseLyrics(text);}).catch(err=>{if(!isAutoPlayNext){lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">无法加载歌词</div>';}});}}else{loading.style.display='none';showError('无法获取千千音乐');}}else if(song.platform==='qishui'){if(song.needsDetailLookup&&song.number){fetch(`https://api-v2.cenguigui.cn/api/qishui/?msg=${encodeURIComponent(song.query)}&n=${song.number}&type=json`).then(response=>response.json()).then(data=>{loading.style.display='none';if(data.code===200&&data.data){const fullSongData={platform:'qishui',title:data.data.title,singer:data.data.singer,cover:data.data.cover,link:data.data.music,lyric:data.data.lrc};if(!isAutoPlayNext){showSongDetail(fullSongData);}updateBottomPlayer(fullSongData);audioPlayer.src=fullSongData.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));if(data.data.lrc){parseLyrics(data.data.lrc);}}else{showError('获取汽水音乐失败');}}).catch(err=>{loading.style.display='none';showError('获取汽水音乐失败');});}else if(song.link){loading.style.display='none';if(!isAutoPlayNext){showSongDetail(song);}updateBottomPlayer(song);audioPlayer.src=song.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));if(song.lyric){parseLyrics(song.lyric);}}else{loading.style.display='none';showError('无法获取汽水音乐');}}else if(song.platform==='ximalaya'){if(song.n&&song.query){fetch(`https://api-v2.cenguigui.cn/api/music/dg_ximalayamusic.php?msg=${encodeURIComponent(song.query)}&n=${song.n}&type=json`).then(response=>response.json()).then(data=>{loading.style.display='none';if(data&&data.code===200){const fullSongData={platform:'ximalaya',title:data.title,singer:data.nickname||song.singer,cover:data.cover,link:data.url};if(!isAutoPlayNext){showSongDetail(fullSongData);}updateBottomPlayer(fullSongData);audioPlayer.src=fullSongData.link;audioPlayer.play().catch(e=>console.log('自动播放被阻止:',e));}else{showError('获取喜马拉雅音乐失败');}}).catch(err=>{loading.style.display='none';showError('获取喜马拉雅音乐失败');});}else{loading.style.display='none';showError('无法获取喜马拉雅音乐');}}}function showSongDetail(songData){songList.style.display='none';songDetail.classList.add('active');detailTitle.textContent=songData.title;detailSinger.textContent=`${songData.singer}${songData.album?' - '+songData.album:''}`;if(songData.cover){coverImg.src=songData.cover;coverImg.style.display='block';}else{coverImg.style.display='none';}let platformText='';switch(songData.platform){case'netease':platformText='来源：网易云音乐';break;case'mg':platformText='来源：咪咕音乐';break;case'qianqian':platformText='来源：千千音乐';break;case'qishui':platformText='来源：汽水音乐';break;case'ximalaya':platformText='来源：喜马拉雅音乐';break;}platformInfo.textContent=platformText;lyricLines=[];currentLyricIndex=-1;lyricsContent.innerHTML='<div class="lyrics-title">Loading...</div><div class="lyrics-content">加载中...</div>';if(songData.lyric){parseLyrics(songData.lyric);}else if(songData.lrc){if(songData.lrc.startsWith('http')){fetch(songData.lrc).then(response=>response.text()).then(text=>{parseLyrics(text);}).catch(err=>{lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">无法加载歌词</div>';});}else{parseLyrics(songData.lrc);}}else{lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">暂无歌词</div>';}currentSongData=songData;}function updateBottomPlayer(songData){bottomPlayer.style.display='flex';playerTitle.textContent=songData.title;playerSinger.textContent=songData.singer;if(songData.cover){playerCover.src=songData.cover;playerCover.style.display='block';}else{playerCover.style.display='none';}currentSongData=songData;}function togglePlayPause(){if(audioPlayer.paused){audioPlayer.play();}else{audioPlayer.pause();}}function playPrevSong(){if(searchResults.length===0)return;isAutoPlayNext=true;if(playMode==='random'){currentSongIndex=Math.floor(Math.random()*searchResults.length);}else{currentSongIndex=(currentSongIndex-1+searchResults.length)%searchResults.length;}getSongDetail(searchResults[currentSongIndex]);}function playNextSong(){if(searchResults.length===0)return;isAutoPlayNext=true;if(playMode==='random'){currentSongIndex=Math.floor(Math.random()*searchResults.length);}else{currentSongIndex=(currentSongIndex+1)%searchResults.length;}getSongDetail(searchResults[currentSongIndex]);}function handleSongEnd(){if(playMode==='single'){audioPlayer.currentTime=0;audioPlayer.play();}else{playNextSong();}}function togglePlayMode(){if(playMode==='list'){playMode='random';playModeBtn.innerHTML='<i class="fas fa-random"></i>';playModeBtn.title='随机播放';}else if(playMode==='random'){playMode='single';playModeBtn.innerHTML='<i class="fas fa-redo"></i>';playModeBtn.title='单曲循环';}else{playMode='list';playModeBtn.innerHTML='<i class="fas fa-repeat"></i>';playModeBtn.title='列表循环';}}function updateProgress(){const currentTime=audioPlayer.currentTime;const duration=audioPlayer.duration;if(duration){const percent=(currentTime/duration)*100;progressFill.style.width=percent+'%';currentTimeEl.textContent=formatTime(currentTime);}}function formatTime(seconds){const mins=Math.floor(seconds/60);const secs=Math.floor(seconds%60);return`${mins}:${secs<10?'0':''}${secs}`;}function parseLyrics(lyrics){lyricLines=[];currentLyricIndex=-1;if(!lyrics||lyrics.trim()===''){if(!isAutoPlayNext){lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">暂无歌词</div>';}return;}const lines=lyrics.trim().split('\n');let hasTimeStamps=false;lines.forEach(line=>{line=line.trim();if(!line)return;const timeMatch=line.match(/\[(\d+):(\d+)(?:\.|:)(\d+)\](.*)/);if(timeMatch){hasTimeStamps=true;const minutes=parseInt(timeMatch[1]),seconds=parseInt(timeMatch[2]),milliseconds=parseInt(timeMatch[3]),text=timeMatch[4].trim();const timeInSeconds=minutes*60+seconds+milliseconds/100;if(text){lyricLines.push({time:timeInSeconds,text:text});}}});lyricLines.sort((a,b)=>a.time-b.time);if(hasTimeStamps&&lyricLines.length>0){if(!isAutoPlayNext){displayLyrics();}}else{if(!isAutoPlayNext){lyricsContent.innerHTML='<div class="lyrics-title">Enjoy</div><div class="lyrics-content">'+lyrics+'</div>';}lyricLines=[];}}function displayLyrics(){lyricsContent.innerHTML='';if(lyricLines.length===0){lyricsContent.innerHTML='<div class="lyrics-title">None</div><div class="lyrics-content">暂无歌词</div>';return;}lyricLines.forEach((line,index)=>{const lyricLine=document.createElement('div');lyricLine.className='lyric-line';lyricLine.textContent=line.text;lyricLine.dataset.index=index;lyricLine.dataset.time=line.time;lyricsContent.appendChild(lyricLine);});currentLyricIndex=-1;}function updateLyrics(){if(lyricLines.length===0||!audioPlayer.duration)return;const currentTime=audioPlayer.currentTime;let activeIndex=-1;lyricLines.forEach((line,index)=>{const lineTime=parseFloat(line.time);if(currentTime>=lineTime){activeIndex=index;}});if(activeIndex!==currentLyricIndex){if(currentLyricIndex>=0){const prevLine=lyricsContent.querySelector(`.lyric-line[data-index="${currentLyricIndex}"]`);if(prevLine){prevLine.classList.remove('active');}}if(activeIndex>=0){const currentLine=lyricsContent.querySelector(`.lyric-line[data-index="${activeIndex}"]`);if(currentLine){currentLine.classList.add('active');currentLine.scrollIntoView({behavior:'smooth',block:'center'});}}currentLyricIndex=activeIndex;}}function showError(message){error.textContent=message;error.style.display='block';}});</script></body></html>